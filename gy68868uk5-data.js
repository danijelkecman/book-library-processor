const RCA_FILE_DATA = '{"updated_at": 1605069469, "version": 1}';
const RCA_STORE_DATA = '{"rc_domain": "protom-club.myshopify.com", "hash": "gy68868uk5", "weight_units": "Grams"}';
const RCA_PRODUCT_DATA = '[
  {
    "id": 1,
    "weight": 0,
    "variants": [
      {
        "id": 261,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      },
      {
        "id": 262,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      },
      {
        "id": 263,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      },
      {
        "id": 264,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      },
      {
        "id": 265,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      },
      {
        "id": 266,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [
      {
        "discount_amount": 23.0,
        "discount_type": "percentage",
        "charge_interval_frequency": 7,
        "order_interval_unit": "day",
        "storefront_purchase_options": "subscription_and_onetime",
        "expire_after_specific_number_of_charges": null,
        "order_interval_frequency_options": [
          "7",
          "14"
        ]
      }
    ],
    "tax_code": "fasc"
  },
  {
    "id": 2,
    "weight": 11,
    "variants": [
      {
        "id": 146,
        "weight": 11,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [
      {
        "discount_amount": 14.0,
        "discount_type": "percentage",
        "charge_interval_frequency": 3,
        "order_interval_unit": "day",
        "storefront_purchase_options": "subscription_and_onetime",
        "expire_after_specific_number_of_charges": null,
        "order_interval_frequency_options": [
          "3",
          "5"
        ]
      }
    ],
    "tax_code": "TEST-TAX-CODE-5"
  },
  {
    "id": 3,
    "weight": 1,
    "variants": [
      {
        "id": 148,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      },
      {
        "id": 149,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      },
      {
        "id": 150,
        "weight": null,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 4,
    "weight": 1,
    "variants": [
      {
        "id": 159,
        "weight": 1,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 5,
    "weight": 1,
    "variants": [
      {
        "id": 162,
        "weight": 1,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 6,
    "weight": 0,
    "variants": [
      {
        "id": 163,
        "weight": 0,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 7,
    "weight": 0,
    "variants": [
      {
        "id": 165,
        "weight": 0,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 8,
    "weight": 1,
    "variants": [
      {
        "id": 168,
        "weight": 1,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 9,
    "weight": 1,
    "variants": [
      {
        "id": 171,
        "weight": 1,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 10,
    "weight": 1,
    "variants": [
      {
        "id": 172,
        "weight": 1,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 14,
    "weight": 1,
    "variants": [
      {
        "id": 255,
        "weight": 1,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  },
  {
    "id": 15,
    "weight": 350,
    "variants": [
      {
        "id": 267,
        "weight": 350,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [
      {
        "discount_amount": 10.0,
        "discount_type": "percentage",
        "charge_interval_frequency": 30,
        "order_interval_unit": "day",
        "storefront_purchase_options": "subscription_and_onetime",
        "expire_after_specific_number_of_charges": null,
        "order_interval_frequency_options": [
          "30",
          "60",
          "90"
        ]
      }
    ],
    "tax_code": "TAX-TEST-153"
  },
  {
    "id": 16,
    "weight": 10,
    "variants": [
      {
        "id": 268,
        "weight": 10,
        "tax_code": null,
        "tax_class_id": ""
      }
    ],
    "discounts": [],
    "subscriptions": [],
    "tax_code": ""
  }
]';
const CUSTOM_CLASS_DATA = '{"theme": "default", "version": null, "header_subtotal_label": {"custom_class": "rca-cart-header-subtotal-label", "selectors": ["[data-cart-content] .cart-header-item:contains(\\"Total\\")"], "parentLevel": 0, "group": "CART"}, "shipping_label": {"custom_class": "rca-cart-shipping", "selectors": ["[data-cart-totals] .cart-total:contains(\\"Shipping\\")"], "parentLevel": 0, "group": "CART"}, "taxes": {"custom_class": "rca-cart-taxes", "selectors": ["[data-cart-totals] .cart-total:contains(\\"Tax\\")"], "parentLevel": 0, "group": "CART"}, "taxes_label": {"custom_class": "rca-cart-taxes-label", "selectors": ["[data-cart-totals] .cart-total-label:contains(\\"Tax\\") strong"], "parentLevel": 0, "group": "CART"}, "taxes_value": {"custom_class": "rca-cart-taxes-value", "selectors": ["[data-cart-totals] .cart-total:contains(\\"Tax\\") .cart-total-value span"], "parentLevel": 0, "group": "CART"}, "subtotal": {"custom_class": "rca-cart-subtotal", "selectors": ["[data-cart-totals] .cart-total:contains(\\"Subtotal\\")"], "parentLevel": 0, "group": "CART"}, "subtotal_label": {"custom_class": "rca-cart-subtotal-label", "selectors": ["[data-cart-totals] .cart-total-label:contains(\\"Subtotal\\") strong"], "parentLevel": 0, "group": "CART"}, "subtotal_value": {"custom_class": "rca-cart-subtotal-value", "selectors": ["[data-cart-totals] .cart-total:contains(\\"Subtotal\\") .cart-total-value span"], "parentLevel": 0, "group": "CART"}, "grandtotal": {"custom_class": "rca-cart-grandtotal", "selectors": ["[data-cart-totals] .cart-total:has(.cart-total-grandTotal)"], "parentLevel": 0, "group": "CART"}, "grandtotal_label": {"custom_class": "rca-cart-grandtotal-label", "selectors": ["[data-cart-totals] .cart-total-label:contains(\\"Grand \\") strong"], "parentLevel": 0, "group": "CART"}, "grandtotal_value": {"custom_class": "rca-cart-grandtotal-value", "selectors": ["[data-cart-totals] .cart-total-value.cart-total-grandTotal span"], "parentLevel": 0, "group": "CART"}, "cart_items": {"custom_class": "rca-cart-items", "selectors": ["[data-cart-content]"], "parentLevel": 0, "group": "CART"}, "cart_totals": {"custom_class": "rca-cart-totals", "selectors": ["[data-cart-totals]"], "parentLevel": 0, "group": "CART"}, "cart_line_item": {"custom_class": "rca-cart-item", "selectors": ["[data-item-row]"], "parentLevel": 0, "group": "CART"}, "cart_line_item_price": {"custom_class": "rca-cart-item-price", "selectors": ["[data-item-row] .cart-item-info > span.cart-item-value"], "parentLevel": 0, "group": "CART"}, "cart_line_item_total": {"custom_class": "rca-cart-item-total", "selectors": ["[data-item-row] .cart-item-info > strong.cart-item-value"], "parentLevel": 0, "group": "CART"}, "cart_line_item_quantity": {"custom_class": "rca-cart-item-quantity", "selectors": ["[data-item-row] .cart-item-info .cart-item-qty-input"], "parentLevel": 0, "group": "CART"}, "cart_line_item_one_time": {"custom_class": "rca-cart-line-item-one-time", "selectors": ["#cartOneTime"], "parentLevel": 0, "group": "CART"}, "cart_line_item_subscribe": {"custom_class": "rca-cart-line-item-subscribe", "selectors": ["#cartSubscribe"], "parentLevel": 0, "group": "CART"}, "cart_discount": {"custom_class": "rca-cart-discount", "selectors": ["[data-cart-totals] .cart-total:contains(\\"Discount\\")"], "parentLevel": 0, "group": "CART"}, "cart_coupon": {"custom_class": "rca-cart-coupon", "selectors": ["[data-cart-totals] .cart-total:contains(\\"Coupon\\")"], "parentLevel": 0, "group": "CART"}, "cart_hide_subscription": {"custom_class": "rca-cart-hide-subscription", "selectors": [".rca-cart-discount", ".rca-cart-coupon", ".rca-cart-gift", ".rca-cart-banner", ".rca-cart-shipping", ".afterpay-paragraph", ".cart-additionalCheckoutButtons"], "parentLevel": 0, "group": "CART"}, "banner": {"custom_class": "rca-cart-banner", "selectors": [".alertBox"], "parentLevel": 0, "group": "CART"}, "cart_remove": {"custom_class": "rca-cart-remove", "selectors": [".cart-remove"], "parentLevel": 0, "group": "CART"}, "cart_dropdown_price": {"custom_class": "rca-cart-dropdown-price", "selectors": [".previewCartItem-content .previewCartItem-price"], "parentLevel": 0, "group": "CART_DROPDOWN"}, "cart_modal_price": {"custom_class": "rca-cart-modal-price", "selectors": [".productView-details .productView-price"], "parentLevel": 0, "group": "CART_MODAL"}, "cart_modal_sub_text": {"custom_class": "rca-cart-modal-sub-text", "selectors": ["#subAndSave"], "parentLevel": 0, "group": "CART_MODAL"}, "cart_modal_subtotal": {"custom_class": "rca-cart-modal-subtotal", "selectors": [".previewCartCheckout-subtotal .previewCartCheckout-price"], "parentLevel": 0, "group": "CART_MODAL"}, "account_manage_subscriptions": {"custom_class": "rca-manage-subscriptions", "selectors": [], "parentLevel": 0, "group": "ACCOUNT"}, "product_price": {"custom_class": "rca-product-price", "selectors": [".productView-price > .price-section > [data-product-price-with-tax]"], "parentLevel": 0, "group": "PRODUCT"}, "product_grid": {"custom_class": "rca-productGrid", "selectors": [".productGrid"], "parentLevel": 0, "group": "CATEGORY"}, "product_hide_subscription": {"custom_class": "rca-product-hide-subscription", "selectors": [], "parentLevel": 0, "group": "PRODUCT"}, "nav_user": {"custom_class": "rca-navUser", "selectors": [".navUser"], "parentLevel": 0, "group": "ALL"}, "product_subscription": {"custom_class": ".productView .productView-options .form-action", "selectors": [".form-action"], "parentLevel": 0, "group": "ALL"}, "account_navbar_section": {"custom_class": "rca-account-navbar-section", "selectors": [".navBar--account > .navBar-section"], "parentLevel": 0, "group": "ACCOUNT"}, "all_mobile_menu_account_section": {"custom_class": "rca-all-mobile-menu-account-section", "selectors": ["#navPages-account > .navPage-subMenu-list"], "parentLevel": 0, "group": "ALL"}, "generic_remove": {"custom_class": "rca-remove-element", "selectors": [], "parentLevel": 0, "group": "REMOVE"}, "generic_hide": {"custom_class": "rca-hide-element", "selectors": [], "parentLevel": 0, "group": "ALL"}}';
class ScriptStorage {
    constructor(RCA_FILE_DATA, RCA_STORE_DATA, RCA_PRODUCT_DATA) {
        this.RCA_FILE_DATA = JSON.parse(RCA_FILE_DATA);
        this.RCA_STORE_DATA = JSON.parse(RCA_STORE_DATA);
        this.RCA_PRODUCT_DATA = JSON.parse(RCA_PRODUCT_DATA);
    }

    getLastFileUpdate() {
        return this.RCA_FILE_DATA.updated_at;
    }

    getFileVersion() {
        return this.RCA_FILE_DATA.version;
    }

    getStoreDomain() {
        return this.RCA_STORE_DATA.rc_domain;
    }

    getStoreHash() {
        return this.RCA_STORE_DATA.hash;
    }

    getStoreWeightUnits() {
        return this.RCA_STORE_DATA.weight_units;
    }

    getStoreClientID() {
        return this.RCA_STORE_DATA.client_id;
    }

    getProductByBCProductID(product_id) {
        for (let i = 0; i < this.RCA_PRODUCT_DATA.length; i++) {
            if (parseInt(this.RCA_PRODUCT_DATA[i].id) === product_id) {
                return this.RCA_PRODUCT_DATA[i];
            }
        }
        return null;
    }

    getSubscriptionsByBCProductID(product_id) {
        for (let i = 0; i < this.RCA_PRODUCT_DATA.length; i++) {
            if (parseInt(this.RCA_PRODUCT_DATA[i].id) === product_id) {
                return this.RCA_PRODUCT_DATA[i].subscriptions;
            }
        }
        return null;
    }

    getVariantsByBCProductID(product_id) {
        for (let i = 0; i < this.RCA_PRODUCT_DATA.length; i++) {
            if (parseInt(this.RCA_PRODUCT_DATA[i].id) === product_id) {
                return this.RCA_PRODUCT_DATA[i].variants;
            }
        }
        return null;
    }

    getProductWeightByBCProductID(product_id) {
        for (let i = 0; i < this.RCA_PRODUCT_DATA.length; i++) {
            if (parseInt(this.RCA_PRODUCT_DATA[i].id) === product_id) {
                return this.RCA_PRODUCT_DATA[i].weight;
            }
        }
        return null;
    }

    getDiscountsByBCProductID(product_id) {
        for (let i = 0; i < this.RCA_PRODUCT_DATA.length; i++) {
            if (parseInt(this.RCA_PRODUCT_DATA[i].id) === product_id) {
                return this.RCA_PRODUCT_DATA[i].discounts;
            }
        }
        return null;
    }
}

class ThemeClasses {
    constructor(CUSTOM_CLASSES) {
        this.classes = JSON.parse(CUSTOM_CLASSES);
        this.theme = JSON.parse(CUSTOM_CLASSES).theme;
    }
    getCustomClass(record_id, withDot = True){
        return this.classes[record_id]['custom_class']
    }
    getCustomClassSelectors(record_id){
        return this.classes[record_id]['selectors']
    }
}
const RCA_DATA = new ScriptStorage(RCA_FILE_DATA, RCA_STORE_DATA, RCA_PRODUCT_DATA);
const CUSTOM_CLASSES = new ThemeClasses(CUSTOM_CLASS_DATA);
